function slide(t,e,i,s,h,n){this.src=t,this.link=e,this.text=i,this.title_text=s,this.target=h,this.attr=n,document.images&&(this.image=new Image),this.loaded=!1,this.load=function(){document.images&&(this.loaded||(this.image.src=this.src,this.loaded=!0))},this.hotlink=function(){var t;this.link&&(this.target?(t=this.attr?window.open(this.link,this.target,this.attr):window.open(this.link,this.target),t&&t.focus&&t.focus()):location.href=this.link)}}function slideshow(t){this.name=t,this.repeat=!0,this.prefetch=-1,this.image,this.textid,this.title_textid,this.textarea,this.timeout=3e3,this.slides=new Array,this.current=0,this.timeoutid=0,this.add_slide=function(t){var e=this.slides.length;-1==this.prefetch&&t.load(),this.slides[e]=t},this.play=function(t){this.pause(),t&&(this.timeout=t),t="undefined"!=typeof this.slides[this.current].timeout?this.slides[this.current].timeout:this.timeout,this.timeoutid=setTimeout(this.name+".loop()",t)},this.pause=function(){0!=this.timeoutid&&(clearTimeout(this.timeoutid),this.timeoutid=0)},this.update=function(){if(this.valid_image()){"function"==typeof this.pre_update_hook&&this.pre_update_hook();var t=this.slides[this.current],e=!1;this.image&&"undefined"!=typeof this.image.filters&&"undefined"!=typeof this.image.filters[0]&&(e=!0);for(var i=0;i<this.slides.length;i++)document.getElementById("featured-nav").getElementsByTagName("a")[i].setAttribute("class","");if(document.getElementById("featured-nav").getElementsByTagName("a")[this.current].setAttribute("class","cur"),t.load(),e&&(t.filter&&this.image.style&&this.image.style.filter&&(this.image.style.filter=t.filter),this.image.filters[0].Apply()),this.image.src=t.image.src,e&&this.image.filters[0].Play(),this.display_text(),this.display_title_text(),"function"==typeof this.post_update_hook&&this.post_update_hook(),this.prefetch>0){var s,h,n;s=this.current,h=this.current,n=0;do++s>=this.slides.length&&(s=0),--h<0&&(h=this.slides.length-1),this.slides[s].load(),this.slides[h].load();while(++n<this.prefetch)}}},this.goto_slide=function(t){-1==t&&(t=this.slides.length-1),t<this.slides.length&&t>=0&&(this.current=t),this.update()},this.goto_random_slide=function(t){var e;if(this.slides.length>1){do e=Math.floor(Math.random()*this.slides.length);while(e==this.current);this.goto_slide(e)}},this.next=function(){this.current<this.slides.length-1?this.current++:this.repeat&&(this.current=0),this.update()},this.previous=function(){this.current>0?this.current--:this.repeat&&(this.current=this.slides.length-1),this.update()},this.shuffle=function(){var t,e,i,s;for(i=new Array,t=0;t<this.slides.length;t++)i[t]=this.slides[t];s=new Array;do{for(t=Math.floor(Math.random()*i.length),s[s.length]=i[t],e=t+1;e<i.length;e++)i[e-1]=i[e];i.length--}while(i.length);this.slides=s},this.get_text=function(){return this.slides[this.current].text},this.get_all_text=function(t,e){for(all_text="",i=0;i<this.slides.length;i++)slide=this.slides[i],slide.text&&(all_text+=t+slide.text+e);return all_text},this.display_text=function(t){if(t||(t=this.slides[this.current].text),this.textarea&&"undefined"!=typeof this.textarea.value&&(this.textarea.value=t),this.textid){if(r=this.getElementById(this.textid),!r)return!1;if("undefined"==typeof r.innerHTML)return!1;r.innerHTML=t}},this.display_title_text=function(t){if(t||(t=this.slides[this.current].title_text),this.title_textid){if(r=this.getElementById(this.title_textid),!r)return!1;if("undefined"==typeof r.innerHTML)return!1;r.innerHTML=t,this.getElementById("featured-title-bg").innerHTML=t}},this.hotlink=function(){this.slides[this.current].hotlink()},this.save_position=function(t){t||(t=this.name+"_slideshow"),document.cookie=t+"="+this.current},this.restore_position=function(t){t||(t=this.name+"_slideshow");var e=t+"=";document.cookie.length>0&&(offset=document.cookie.indexOf(e),-1!=offset&&(offset+=e.length,end=document.cookie.indexOf(";",offset),-1==end&&(end=document.cookie.length),this.current=parseInt(unescape(document.cookie.substring(offset,end)))))},this.noscript=function(){for($html="\n",i=0;i<this.slides.length;i++)slide=this.slides[i],$html+="<P>",slide.link&&($html+='<a href="'+slide.link+'">'),$html+='<img src="'+slide.src+'" ALT="slideshow image">',slide.link&&($html+="</a>"),slide.text&&($html+="<BR>\n"+slide.text),$html+="</P>\n\n";return $html=$html.replace(/\&/g,"&amp;"),$html=$html.replace(/</g,"&lt;"),$html=$html.replace(/>/g,"&gt;"),"<pre>"+$html+"</pre>"},this.loop=function(){this.current<this.slides.length-1?(next_slide=this.slides[this.current+1],(null==next_slide.image.complete||next_slide.image.complete)&&this.next()):this.next(),this.play()},this.valid_image=function(){return this.image?!0:!1},this.getElementById=function(t){return document.getElementById?document.getElementById(t):document.all?document.all[t]:document.layers?document.layers[t]:void 0},this.set_image=function(t){document.images&&(this.image=t)},this.set_textarea=function(t){this.textarea=t,this.display_text()},this.set_textid=function(t){this.textid=t,this.display_text()}}